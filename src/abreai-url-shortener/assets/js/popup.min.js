async function shortenUrl(longUrl){if(!/^https?:\/\//.test(longUrl))throw new Error("Invalid input URL");const response=await fetch("https://abre.ai/_/generate.txt",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({url_translation:{url:longUrl,token:""}})});return response.text()}function showResult(shortUrl){const qr=document.getElementById("qr"),input=document.getElementById("url"),msg=document.getElementById("copied");input.value=shortUrl,new QRCode(qr,{text:shortUrl,width:270,height:270}),qr.className="done",input.parentElement.onclick=function(){input.select(),document.execCommand("copy")&&(msg.className="visible",setTimeout(()=>{msg.className=""},2e3))}}function showError(){const qr=document.getElementById("qr");qr.className="error"}chrome.tabs.query({currentWindow:!0,active:!0},(function(tabs){const longUrl=tabs[0].url;shortenUrl(longUrl).then(showResult).catch(showError)})),document.getElementById("copied").textContent=chrome.i18n.getMessage("copied");